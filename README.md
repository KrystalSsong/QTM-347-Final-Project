# Predictions of Cohort Loan Default Rates Based on ML Models

## Abstract
This project investigates the default rates of student loans within two years of graduation using the "Most-Recent-Cohorts-Institution" dataset. The analysis focuses on variables such as institution type, student demographics, academic factors, and environmental conditions, chosen for their relevance and significant correlation with loan default rates. We employ a combination of, forward selection, and lasso regression for feature selection, alongside decision tree and random forest regressor for predictive modelling. Additionally, classification techniques like decision trees and random forests are used to identify key patterns. The study aims to provide insights useful for policymakers and educational institutions in developing strategies to mitigate loan default risks.

## Introduction
### Problem Statement and Motivation
The problem we are addressing is the investigation of the default rate of student loans within two years of graduation. A student is granted default status if the student fails to repay within 270 days of repayment date. The primary goal is to identify the key factors that influence this default rate, focusing on a range of variables such as the nature of the institution (public or private), student demographics (race, gender), academic factors (highest degree awarded, majors), environmental aspects (student to faculty ratio, part-time or full-time status), and median incomes of students after graduation.

This investigation is driven by the increasing concern over student loan debt and its impact on both individuals and the economy. The topic is especially relevant in todayâ€™s market environment. As we are going under economic downturns and multiple hiring freezes across industries, students are struggling to obtain income to pay off their debts, which can leave negative long-term impacts on their credit records. On a broader scale, as more students default, the Federal government will be forced into providing easing strategies, such as student loan forgiveness. However, such easing can lead to higher consumer expenditures as the stress of repayments is alleviated. As a result, the easing of student loans can lead to more inflations, which have been one of the biggest issues faced by the U.S. economy.

Understanding the factors that lead to loan defaults can provide critical insights for policymakers, educational institutions, and financial organisations. This problem is particularly interesting as it intersects with broader issues such as educational equity, economic stability, and social mobility. The insights gained from this study can be instrumental in shaping policies and practices that aim to reduce the financial burden on students and mitigate the risk of loan defaults. Use cases for this research are found in higher education policy formulation, financial counselling for students, and strategic planning by educational institutions.

### Approach and Methodology
To tackle this problem, we propose a multifaceted analytical approach using forward selection and lasso regression for feature selection, supplemented by decision tree and random forest regressor for predictive modelling. Additionally, we employ decision trees and random forest classifiers for classification purposes. This approach is advantageous as it combines the strength of various techniques: decision trees for their interpretability and ability to handle non-linear relationships, lasso regression for its efficacy in feature reduction and handling overfitting, and PLS regression for its ability to deal with multicollinearity in predictor variables. Logistic regression provides a robust framework for predicting categorical outcomes and control overfitting. Decision trees classifier offers a simple and interpretable structure for decision-making, requiring little data preparation and effectively handling both numerical and categorical data, while random forests classifier generates high accuracy by aggregating results from multiple decision trees, thus preventing overfitting and handling unbalanced datasets effectively. Our approach differs from traditional linear methods by incorporating a more nuanced analysis that can capture complex patterns within the data. Key components of our methodology include a comprehensive data preprocessing phase, rigorous feature selection to identify the most influential variables, and a combination of predictive models to capture different aspects of the data. However, this approach has limitations, such as the potential for overfitting in decision trees and the sensitivity of lasso regression to the choice of tuning parameters. Moreover, our models' predictive accuracy is contingent on the representativeness and quality of the dataset used.

## Setup
### Dataset
The dataset Most-Recent-Cohorts-Institution is an extensive compilation of data provided by the U.S. Department of Education. It is highly detailed and multifaceted, and contains 6,543 observations, detailing institutional characteristics, enrollment, student aid, costs, and student outcomes. The scale and diversity of variables provide insights into aspects like student demographics, academic offerings, institutional characteristics, student financials and loan default rates.

### Data Cleaning
We begin by refining our dataset to ensure its relevance and completeness. Firstly, we eliminate columns with fewer than 4000 observations or those marked as 'PrivacySuppressed'. We then focus on observations that are relevant to operating main campus institutions only. Essential attributes such as basic school information, student demographics, academic factors, and default rates are manually selected for further analysis. Observations with significant missing data across most variables are discarded. To deal with remaining missing values, we employ a group-by strategy, finding average values within each group, and calculating percentages where applicable.
The next step involves encoding the data to make it suitable for analysis. Numerical columns are standardised through the calculation of z-scores, which normalise the data by its mean and standard deviation, ensuring comparability across different scales. Categorical columns, on the other hand, are transformed using one-hot encoding, a technique that converts categorical variables into a form that could be provided to machine learning algorithms for better prediction. 
Finally, we focus on consolidating our pre-processed data. We concatenate the numeric and categorical datasets. For the one-hot encoded columns, we also compute z-scores, similar to the numeric columns, to maintain consistency in normalisation across the dataset. This step ensures that all features, regardless of their original format, are standardised and ready for advanced analysis. The resultant z-score normalised data frames, both numeric and categorical, are then concatenated to form a comprehensive, normalised dataset. This meticulous preparation renders the data primed for robust and accurate analytical modelling.

### Exploratory Analysis
Upon thorough review of our cleaned data set, we uncovered that the mean two-year cohort default rate sits around 8.4%, but it peaks at an alarming 50% for some institutions. A deeper dive using the groupby function exposed a trend: private for-profit institutions and those whose highest award degree is associate degrees consistently register higher default rates. In a geographical context, educational institutions located in Nevada manifest a notably higher default risk.

Correlation analysis between various features and the default rate brought to light some insightful patterns. The variable HIGHDEG_2, indicative of schools where the highest degree conferred is an associate's, has the highest positive correlation with the default rate. This suggests that schools offering up to associate degrees may not be providing sufficient career and earning prospects to aid graduates in loan repayment.

On the flip side, MD_EARN_WNE_MALE0_P8, capturing the median earnings of female graduates who are employed and not enrolled in further studies after eight years, showed a strong negative correlation with the default rate. The higher median earnings are indicative of better financial well-being among graduates, which in turn correlates with a lower propensity for loan default.





